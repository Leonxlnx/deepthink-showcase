<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nature Style - Features & Testimonials</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500&family=Playfair+Display:ital,wght@0,400;0,500;0,600;1,400&display=swap"
        rel="stylesheet">

    <style>
        /* =========================================
           NATURE THEME VARIABLES
           ========================================= */
        :root {
            --forest-dark: #070c08;
            --forest-mid: #132215;
            --moss: #2d4a22;
            --sage: #8a9a86;
            --gold: #e6c27a;
            --gold-glow: rgba(230, 194, 122, 0.4);
            --text-main: #f0f4f0;
            --text-muted: #a3b19f;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body,
        html {
            width: 100%;
            height: 100%;
            overflow: hidden;
            background-color: var(--forest-dark);
            font-family: 'Outfit', sans-serif;
            color: var(--text-main);
            cursor: none;
            /* Custom firefly cursor */
        }

        a,
        button,
        .leaf-node,
        .nature-card-wrapper {
            cursor: none;
        }

        /* Re-enable default cursor for touch devices */
        @media (pointer: coarse) {

            body,
            html,
            a,
            button,
            .leaf-node,
            .nature-card-wrapper {
                cursor: auto;
            }
        }

        /* =========================================
           CUSTOM FIREFLY CURSOR
           ========================================= */
        .cursor-firefly {
            position: fixed;
            width: 8px;
            height: 8px;
            background: var(--gold);
            border-radius: 50%;
            pointer-events: none;
            z-index: 9999;
            box-shadow: 0 0 15px var(--gold), 0 0 30px var(--gold);
            transform: translate(-50%, -50%);
            mix-blend-mode: screen;
        }

        .cursor-trail {
            position: fixed;
            width: 40px;
            height: 40px;
            border: 1px solid rgba(230, 194, 122, 0.4);
            border-radius: 50%;
            pointer-events: none;
            z-index: 9998;
            transform: translate(-50%, -50%);
            transition: width 0.3s, height 0.3s, background 0.3s;
        }

        .cursor-trail.hovering {
            width: 60px;
            height: 60px;
            background: rgba(230, 194, 122, 0.1);
            border-color: rgba(230, 194, 122, 0.8);
        }

        /* =========================================
           BACKGROUND & ENVIRONMENT
           ========================================= */
        #nature-testimonials {
            position: relative;
            width: 100vw;
            height: 100vh;
            overflow: hidden;
        }

        .bg-forest {
            position: absolute;
            inset: -5%;
            background-image: url('https://images.unsplash.com/photo-1448375240586-882707db888b?q=80&w=2560&auto=format&fit=crop');
            background-size: cover;
            background-position: center;
            filter: brightness(0.25) contrast(1.1) grayscale(0.2);
            animation: slowZoom 60s linear infinite alternate;
            z-index: 0;
        }

        @keyframes slowZoom {
            0% {
                transform: scale(1);
            }

            100% {
                transform: scale(1.05);
            }
        }

        .bg-overlay {
            position: absolute;
            inset: 0;
            background: radial-gradient(circle at 30% 0%, rgba(230, 194, 122, 0.12), rgba(7, 12, 8, 0.95) 70%);
            z-index: 1;
        }

        #fireflies-canvas {
            position: absolute;
            inset: 0;
            z-index: 2;
            pointer-events: none;
        }

        .container {
            position: relative;
            z-index: 3;
            width: 100%;
            height: 100%;
        }

        /* =========================================
           HEADER SECTION
           ========================================= */
        .header {
            position: absolute;
            top: 8vh;
            left: 50%;
            transform: translateX(-50%);
            text-align: center;
            z-index: 10;
            width: 90%;
            max-width: 800px;
            pointer-events: none;
        }

        .feature-badge {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 8px 20px;
            background: rgba(230, 194, 122, 0.08);
            border: 1px solid rgba(230, 194, 122, 0.3);
            border-radius: 30px;
            color: var(--gold);
            font-size: 0.8rem;
            letter-spacing: 1.5px;
            text-transform: uppercase;
            margin-bottom: 1.5rem;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .feature-badge svg {
            filter: drop-shadow(0 0 4px var(--gold-glow));
        }

        .title {
            font-family: 'Playfair Display', serif;
            font-size: clamp(2.8rem, 5vw, 4.5rem);
            color: var(--text-main);
            margin-bottom: 1rem;
            line-height: 1.1;
            font-weight: 500;
        }

        .title i {
            color: var(--gold);
            font-style: italic;
            font-weight: 400;
        }

        .subtitle {
            font-size: 1.1rem;
            color: var(--text-muted);
            font-weight: 300;
            line-height: 1.6;
            max-width: 600px;
            margin: 0 auto;
        }

        /* =========================================
           3D RIVER CAROUSEL
           ========================================= */
        .carousel-area {
            position: absolute;
            top: 55%;
            left: 50%;
            width: 100vw;
            height: 50vh;
            transform: translate(-50%, -50%);
            perspective: 1500px;
            transform-style: preserve-3d;
        }

        .nature-card-wrapper {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 420px;
            height: 500px;
            transform-style: preserve-3d;
            cursor: grab;
        }

        .nature-card-wrapper:active {
            cursor: grabbing;
        }

        .nature-card {
            position: relative;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(23, 40, 25, 0.4), rgba(7, 12, 8, 0.6));
            border: 1px solid rgba(138, 154, 134, 0.2);
            border-radius: 24px;
            padding: 3rem 2.5rem;
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            transition: border-color 0.5s, background 0.5s;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.5);
            transform-style: preserve-3d;
        }

        /* Fake depth shadow layer to save performance vs filter blur */
        .dark-overlay {
            position: absolute;
            inset: 0;
            background: #040805;
            z-index: 10;
            pointer-events: none;
            border-radius: 24px;
            /* JS handles opacity */
        }

        .nature-card-wrapper.active .nature-card {
            border-color: rgba(230, 194, 122, 0.4);
            background: linear-gradient(135deg, rgba(30, 50, 33, 0.65), rgba(11, 20, 12, 0.9));
            box-shadow: 0 30px 60px rgba(0, 0, 0, 0.6), inset 0 0 40px rgba(230, 194, 122, 0.05);
        }

        /* Interactive warm sunlight glow inside card */
        .nature-card::after {
            content: '';
            position: absolute;
            inset: 0;
            background: radial-gradient(600px circle at var(--mouse-x, 50%) var(--mouse-y, 50%), rgba(230, 194, 122, 0.1), transparent 50%);
            opacity: 0;
            transition: opacity 0.3s;
            pointer-events: none;
            z-index: 1;
        }

        .nature-card:hover::after {
            opacity: 1;
        }

        /* Huge subtle background quote */
        .bg-quote {
            position: absolute;
            top: -20px;
            right: 20px;
            font-family: 'Playfair Display', serif;
            font-size: 15rem;
            color: var(--gold);
            opacity: 0.02;
            line-height: 1;
            pointer-events: none;
            z-index: 0;
            transition: all 0.5s ease;
        }

        @keyframes floatQuote {
            0% {
                transform: translateY(0) scale(1.05);
            }

            50% {
                transform: translateY(-15px) scale(1.05);
            }

            100% {
                transform: translateY(0) scale(1.05);
            }
        }

        .nature-card-wrapper.active .bg-quote {
            opacity: 0.08;
            animation: floatQuote 6s ease-in-out infinite;
        }

        /* =========================================
           CARD INTERNAL CONTENT
           ========================================= */
        .card-content {
            position: relative;
            z-index: 2;
            display: flex;
            flex-direction: column;
            height: 100%;
        }

        .feature-tag {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            color: var(--gold);
            margin-bottom: 2rem;
            padding-bottom: 6px;
            border-bottom: 1px solid rgba(230, 194, 122, 0.2);
        }

        .feature-tag svg {
            stroke: var(--gold);
            filter: drop-shadow(0 0 5px var(--gold-glow));
        }

        .quote-wrapper {
            font-family: 'Playfair Display', serif;
            font-size: 1.25rem;
            line-height: 1.6;
            color: var(--text-main);
            flex-grow: 1;
            font-weight: 400;
            font-style: italic;
        }

        .quote-word {
            display: inline-block;
            opacity: 0.1;
            filter: blur(4px);
            transform: translateY(10px);
            transition: opacity 0.6s cubic-bezier(0.2, 0.8, 0.2, 1),
                filter 0.6s cubic-bezier(0.2, 0.8, 0.2, 1),
                transform 0.6s cubic-bezier(0.2, 0.8, 0.2, 1);
        }

        .nature-card-wrapper.active .quote-word {
            opacity: 1;
            filter: blur(0);
            transform: translateY(0);
        }

        /* Author Block */
        .author-section {
            display: flex;
            align-items: center;
            gap: 1.2rem;
            margin-top: auto;
            border-top: 1px solid rgba(138, 154, 134, 0.15);
            padding-top: 1.5rem;
        }

        .author-avatar {
            width: 55px;
            height: 55px;
            border-radius: 40% 60% 70% 30% / 40% 50% 60% 50%;
            border: 1px solid rgba(138, 154, 134, 0.5);
            padding: 3px;
            animation: morph 8s ease-in-out infinite alternate;
            transition: all 0.4s ease;
        }

        @keyframes morph {
            0% {
                border-radius: 40% 60% 70% 30% / 40% 50% 60% 50%;
            }

            34% {
                border-radius: 70% 30% 50% 50% / 30% 30% 70% 70%;
            }

            67% {
                border-radius: 100% 60% 60% 100% / 100% 100% 60% 60%;
            }

            100% {
                border-radius: 40% 60% 70% 30% / 40% 50% 60% 50%;
            }
        }

        .author-avatar img {
            width: 100%;
            height: 100%;
            border-radius: inherit;
            object-fit: cover;
            filter: sepia(0.3) contrast(1.1) brightness(0.6);
            transition: filter 0.5s;
        }

        .nature-card-wrapper.active .author-avatar {
            border-color: var(--gold);
            box-shadow: 0 0 15px rgba(230, 194, 122, 0.2);
        }

        .nature-card-wrapper.active .author-avatar img {
            filter: sepia(0) contrast(1.1) brightness(1);
        }

        .author-info {
            display: flex;
            flex-direction: column;
        }

        .author-name {
            font-size: 1.05rem;
            font-weight: 500;
            color: var(--text-main);
        }

        .author-role {
            font-size: 0.8rem;
            color: var(--text-muted);
            margin-top: 2px;
        }

        /* =========================================
           VINE TRACKER (Leaves)
           ========================================= */
        .vine-tracker {
            position: absolute;
            bottom: 6vh;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            align-items: center;
            z-index: 20;
            width: 350px;
            height: 40px;
        }

        .vine-line {
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent, rgba(138, 154, 134, 0.5), transparent);
            z-index: 1;
        }

        .leaves-container {
            position: relative;
            z-index: 2;
            display: flex;
            justify-content: space-between;
            width: 100%;
        }

        .leaf-node {
            width: 30px;
            height: 30px;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
        }

        .leaf-shape {
            width: 10px;
            height: 10px;
            background: rgba(138, 154, 134, 0.4);
            border-radius: 12px 2px 12px 2px;
            transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .leaf-node:hover .leaf-shape {
            background: rgba(230, 194, 122, 0.6);
        }

        .leaf-node.active .leaf-shape {
            background: var(--gold);
            box-shadow: 0 0 15px var(--gold-glow);
            transform: scale(1.8) rotate(15deg);
        }

        /* Responsive Adjustments */
        @media (max-width: 768px) {
            .header {
                top: 6vh;
            }

            .title {
                font-size: 2.2rem;
            }

            .nature-card-wrapper {
                width: 320px;
                height: 460px;
            }

            .nature-card {
                padding: 2.5rem 1.8rem;
            }

            .bg-quote {
                font-size: 10rem;
                top: -10px;
            }

            .quote-wrapper {
                font-size: 1.1rem;
            }

            .vine-tracker {
                width: 280px;
            }
        }
    </style>
</head>

<body>

    <div class="cursor-firefly" id="cursor-dot"></div>
    <div class="cursor-trail" id="cursor-trail"></div>

    <section id="nature-testimonials">
        <div class="bg-forest"></div>
        <div class="bg-overlay"></div>
        <canvas id="fireflies-canvas"></canvas>

        <div class="container">
            <header class="header">
                <div class="feature-badge">
                    <svg viewBox="0 0 24 24" width="14" height="14" fill="currentColor">
                        <path
                            d="M17.5,3C13.81,3 10.65,5.1 9.14,8.21C8.78,8.14 8.4,8.1 8,8.1C4.69,8.1 2,10.79 2,14.1C2,17.41 4.69,20.1 8,20.1C10.74,20.1 13.06,18.25 13.81,15.74C14.93,16.54 16.32,17 17.81,17C21.22,17 24,14.22 24,10.81C24,6.4 21.05,3 17.5,3 M11.13,12.78C10.6,14.54 8.92,15.86 7,15.86C4.79,15.86 3,14.07 3,11.86C3,9.65 4.79,7.86 7,7.86C8.8,7.86 10.36,8.96 10.92,10.58C9.52,11.53 8.5,13.06 8.16,14.86C8.69,14.47 9.35,14.23 10.05,14.23C10.45,14.23 10.82,14.31 11.13,14.43V12.78Z" />
                    </svg>
                    Ecosystem Features
                </div>
                <h2 class="title">Natural <i>Growth</i></h2>
                <p class="subtitle">Experience how our platform roots deeply into your workflow, cultivating organic
                    scalability and sustainable integration through the voices of our partners.</p>
            </header>

            <div class="carousel-area" id="carousel">
            </div>

            <div class="vine-tracker">
                <div class="vine-line"></div>
                <div class="leaves-container" id="tracker-nodes">
                </div>
            </div>
        </div>
    </section>

    <script>
        /* =========================================
           1. DATA INJECTION (Features & Quotes)
           ========================================= */
        const featuresData = [
            {
                feature: "Organic Scalability",
                icon: '<path d="M12 22V8M7 12l5-5 5 5"/>',
                quote: "Our ecosystem was struggling under the weight of sudden traffic. This architecture allowed us to scale naturally, branching out without losing structural integrity.",
                name: "Elias Thorne",
                role: "Director of Operations",
                img: "https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?q=80&w=150&auto=format&fit=crop"
            },
            {
                feature: "Seamless Integration",
                icon: '<path d="M12 22V12M12 12H2M12 12h10M12 2v10"/>',
                quote: "It rooted itself directly into our legacy systems. The transition was so fluid, it felt less like an installation and more like a natural evolution of our workflow.",
                name: "Sylvia Chen",
                role: "Lead Systems Architect",
                img: "https://images.unsplash.com/photo-1494790108377-be9c29b29330?q=80&w=150&auto=format&fit=crop"
            },
            {
                feature: "Predictive Analytics",
                icon: '<circle cx="12" cy="12" r="10"/><path d="M12 16v-4M12 8h.01"/>',
                quote: "The forecasting models are uncanny. It senses shifts in user behavior long before they surface, allowing us to adapt like a forest anticipating the changing seasons.",
                name: "Marcus Vane",
                role: "Head of Data Science",
                img: "https://images.unsplash.com/photo-1519085360753-af0119f7cbe7?q=80&w=150&auto=format&fit=crop"
            },
            {
                feature: "Resilient Security",
                icon: '<path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/>',
                quote: "A truly impenetrable canopy. Threats are neutralized at the perimeter. It has given our infrastructure the resilience of an ancient redwood against digital storms.",
                name: "Dr. Aris Vance",
                role: "Chief Security Officer",
                img: "https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?q=80&w=150&auto=format&fit=crop"
            },
            {
                feature: "Fluid Collaboration",
                icon: '<path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 14c-2.21 0-4-1.79-4-4s1.79-4 4-4 4 1.79 4 4-1.79 4-4 4z"/>',
                quote: "Cross-departmental silos dissolved instantly. Information now flows through our company like a river, nourishing every team with real-time, actionable insights.",
                name: "Lena Rostova",
                role: "VP of Product",
                img: "https://images.unsplash.com/photo-1438761681033-6461ffad8d80?q=80&w=150&auto=format&fit=crop"
            }
        ];

        const carousel = document.getElementById('carousel');
        const trackerNodes = document.getElementById('tracker-nodes');

        featuresData.forEach((data, index) => {
            // Word-by-word structural build
            const words = data.quote.split(' ').map((word, i) => {
                return `<span class="quote-word" style="transition-delay: ${i * 0.03}s">${word}&nbsp;</span>`;
            }).join('');

            // Build Card
            const wrapper = document.createElement('div');
            wrapper.className = 'nature-card-wrapper';
            wrapper.innerHTML = `
                <div class="nature-card">
                    <div class="dark-overlay"></div>
                    <div class="bg-quote">"</div>
                    <div class="card-content">
                        <div class="feature-tag">
                            <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                ${data.icon}
                            </svg>
                            <span>${data.feature}</span>
                        </div>
                        <p class="quote-wrapper">${words}</p>
                        <div class="author-section">
                            <div class="author-avatar">
                                <img src="${data.img}" alt="${data.name}" draggable="false">
                            </div>
                            <div class="author-info">
                                <span class="author-name">${data.name}</span>
                                <span class="author-role">${data.role}</span>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            carousel.appendChild(wrapper);

            // Build Tracker Leaf
            const node = document.createElement('div');
            node.className = 'leaf-node';
            node.innerHTML = `<div class="leaf-shape"></div>`;
            node.addEventListener('mousedown', () => {
                targetIndex = index;
                autoPlay = false;
            });
            trackerNodes.appendChild(node);
        });

        /* =========================================
           2. 3D RIVER CAROUSEL LOGIC
           ========================================= */
        const cards = document.querySelectorAll('.nature-card-wrapper');
        const leaves = document.querySelectorAll('.leaf-node');

        let currentIndex = 0;
        let targetIndex = 0;
        let activeIndex = -1;
        let autoPlay = true;
        let playDir = 1;

        let mouseX = window.innerWidth / 2;
        let mouseY = window.innerHeight / 2;

        function updateCarousel() {
            // Smooth lerp
            currentIndex += (targetIndex - currentIndex) * 0.08;
            let newActive = Math.round(currentIndex);

            let isMobile = window.innerWidth < 768;
            let spacing = isMobile ? 310 : 480;

            cards.forEach((card, i) => {
                let offset = i - currentIndex;

                // 3D Math for a flowing river curve
                let x = offset * spacing;
                let y = Math.sin(offset * 1.5) * 60;
                let z = -Math.abs(offset) * 200;

                let rotateZ = Math.sin(offset * 1.5) * -4;
                let rotateY = offset * -15;

                let scale = Math.max(0.6, 1 - Math.abs(offset) * 0.15);
                let opacity = Math.max(0, 1 - Math.abs(offset) * 0.5);

                card.style.transform = `translate(-50%, -50%) translate3d(${x}px, ${y}px, ${z}px) rotateY(${rotateY}deg) rotateZ(${rotateZ}deg) scale(${scale})`;
                card.style.opacity = opacity;
                card.style.zIndex = Math.round(100 - Math.abs(offset) * 10);

                // Depth shadow layer
                let darkness = Math.min(0.75, Math.abs(offset) * 0.4);
                card.querySelector('.dark-overlay').style.opacity = darkness;

                // Active Card State & Magnetic Hover Tilt
                if (Math.abs(offset) < 0.1) {
                    card.classList.add('active');

                    let inner = card.querySelector('.nature-card');
                    let rect = card.getBoundingClientRect();
                    let relX = mouseX - (rect.left + rect.width / 2);
                    let relY = mouseY - (rect.top + rect.height / 2);

                    // Spotlight glow coords
                    inner.style.setProperty('--mouse-x', `${relX + rect.width / 2}px`);
                    inner.style.setProperty('--mouse-y', `${relY + rect.height / 2}px`);

                    if (!isMobile) {
                        let tiltX = (relY / rect.height) * -8;
                        let tiltY = (relX / rect.width) * 8;
                        inner.style.transform = `perspective(1000px) rotateX(${tiltX}deg) rotateY(${tiltY}deg)`;
                    }
                } else {
                    card.classList.remove('active');
                    card.querySelector('.nature-card').style.transform = `perspective(1000px) rotateX(0deg) rotateY(0deg)`;
                }
            });

            // Update UI Tracker
            if (newActive !== activeIndex) {
                activeIndex = newActive;
                leaves.forEach((l, i) => {
                    if (i === activeIndex) l.classList.add('active');
                    else l.classList.remove('active');
                });
            }

            requestAnimationFrame(updateCarousel);
        }
        updateCarousel();

        /* =========================================
           3. INTERACTIVE DRAGGING & AUTOPLAY
           ========================================= */
        let isDragging = false;
        let startX = 0;
        let dragStartIndex = 0;
        let dragVelocity = 0;
        let lastX = 0;

        function dragStart(x) {
            isDragging = true; autoPlay = false;
            startX = x; lastX = x; dragStartIndex = targetIndex;
        }

        function dragMove(x) {
            if (!isDragging) return;
            let diff = (startX - x) / 300;
            targetIndex = dragStartIndex + diff;
            dragVelocity = x - lastX;
            lastX = x;

            // Soft limits
            if (targetIndex < -0.2) targetIndex = -0.2;
            if (targetIndex > featuresData.length - 0.8) targetIndex = featuresData.length - 0.8;
        }

        function dragEnd() {
            if (!isDragging) return;
            isDragging = false;
            targetIndex -= dragVelocity * 0.05; // momentum
            targetIndex = Math.round(targetIndex); // snap
            targetIndex = Math.max(0, Math.min(targetIndex, featuresData.length - 1));
        }

        // Event Listeners
        carousel.addEventListener('mousedown', e => dragStart(e.clientX));
        window.addEventListener('mousemove', e => dragMove(e.clientX));
        window.addEventListener('mouseup', dragEnd);

        carousel.addEventListener('touchstart', e => dragStart(e.touches[0].clientX), { passive: true });
        window.addEventListener('touchmove', e => dragMove(e.touches[0].clientX), { passive: true });
        window.addEventListener('touchend', dragEnd);

        // Auto Play
        setInterval(() => {
            if (autoPlay && !isDragging) {
                targetIndex += 0.0025 * playDir;
                if (targetIndex >= featuresData.length - 0.5) playDir = -1;
                else if (targetIndex <= 0.5) playDir = 1;
            }
        }, 16);

        /* =========================================
           4. DYNAMIC CANVAS FIREFLIES & CURSOR
           ========================================= */
        const cursorDot = document.getElementById('cursor-dot');
        const cursorTrail = document.getElementById('cursor-trail');

        const cvs = document.getElementById('fireflies-canvas');
        const ctx = cvs.getContext('2d');
        let w, h;
        let fireflies = [];

        function initCanvas() {
            w = cvs.width = window.innerWidth;
            h = cvs.height = window.innerHeight;
            fireflies = [];
            let count = Math.floor((w * h) / 10000);
            for (let i = 0; i < count; i++) {
                fireflies.push({
                    x: Math.random() * w, y: Math.random() * h,
                    s: Math.random() * 2 + 0.5,
                    vx: (Math.random() - 0.5) * 0.4, vy: (Math.random() - 0.5) * 0.4,
                    angle: Math.random() * Math.PI * 2, da: (Math.random() - 0.5) * 0.05,
                    alpha: Math.random() * 0.5 + 0.2
                });
            }
        }
        window.addEventListener('resize', initCanvas);
        initCanvas();

        let trailX = mouseX, trailY = mouseY;
        const isFinePointer = window.matchMedia("(pointer: fine)").matches;

        if (!isFinePointer) {
            cursorDot.style.display = 'none';
            cursorTrail.style.display = 'none';
        }

        function drawEnvironment() {
            ctx.clearRect(0, 0, w, h);

            // Cursor Logic
            if (isFinePointer) {
                trailX += (mouseX - trailX) * 0.15;
                trailY += (mouseY - trailY) * 0.15;
                cursorDot.style.transform = `translate(${mouseX}px, ${mouseY}px) translate(-50%, -50%)`;
                cursorTrail.style.transform = `translate(${trailX}px, ${trailY}px) translate(-50%, -50%)`;
            }

            // Fireflies Logic
            fireflies.forEach(f => {
                f.angle += f.da;
                f.x += f.vx + Math.cos(f.angle) * 0.3;
                f.y += f.vy + Math.sin(f.angle) * 0.3;

                if (f.x < -10) f.x = w + 10; if (f.x > w + 10) f.x = -10;
                if (f.y < -10) f.y = h + 10; if (f.y > h + 10) f.y = -10;

                // Repel from cursor
                if (isFinePointer) {
                    let dx = mouseX - f.x, dy = mouseY - f.y;
                    let dist = Math.hypot(dx, dy);
                    if (dist < 150) {
                        f.x -= (dx / dist) * 1.5;
                        f.y -= (dy / dist) * 1.5;
                    }
                }

                let curAlpha = f.alpha + Math.sin(f.angle) * 0.2;
                let grad = ctx.createRadialGradient(f.x, f.y, 0, f.x, f.y, f.s * 4);
                grad.addColorStop(0, `rgba(230, 194, 122, ${curAlpha})`);
                grad.addColorStop(1, `rgba(230, 194, 122, 0)`);

                ctx.fillStyle = grad;
                ctx.beginPath(); ctx.arc(f.x, f.y, f.s * 4, 0, Math.PI * 2); ctx.fill();

                ctx.fillStyle = `rgba(255, 255, 255, ${curAlpha + 0.3})`;
                ctx.beginPath(); ctx.arc(f.x, f.y, f.s * 0.5, 0, Math.PI * 2); ctx.fill();
            });

            requestAnimationFrame(drawEnvironment);
        }
        drawEnvironment();

        // Cursor hover states
        window.addEventListener('mousemove', e => { mouseX = e.clientX; mouseY = e.clientY; });
        if (isFinePointer) {
            const interactables = document.querySelectorAll('.nature-card-wrapper, .leaf-node');
            interactables.forEach(el => {
                el.addEventListener('mouseenter', () => cursorTrail.classList.add('hovering'));
                el.addEventListener('mouseleave', () => cursorTrail.classList.remove('hovering'));
            });
        }
    </script>
</body>

</html>